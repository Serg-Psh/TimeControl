tc - (TimeControl)
История началась где-то 2009-2010 годах.
Задача стояла в ограничении времени, проводимого Стасом за компьютером, и "зарабатывание" им этого времени, путём решения математических задач и других заданий.


28.02.2012 Решил не создавать базу, если её нет (слишком сложно ради единственного раза).
Структура предполагается следующая:
Таблица Tasks:
**	id		- идентификатор
	Task	- Задача (вопрос) с соответствующими html-тэгами. В каждом тэге должен быть атрибут "RA" с правильным вариантом.
	Weight	- Вес задачи - количество баллов/минут, набираемых при правильном решении задачи
	Changed	- Метка времени, когда была изменена запись


Таблица Answers:
	idTask	- идентификатор задачи
	Solved	- считается ли задача решенной (все поля заполнены как указано в атрибуте "RA")
	DT		- дата и время ответа
	Answer	- сам ответ - поля перечислены через ";". Каждое поле представлено введённым значением и правильным ответом, перечислеными через ":"
	Changed	- Метка времени, когда была изменена запись


Строки при создании таблиц теоретически должны быть такими:
CREATE TABLE Tasks (id INTEGER PRIMARY KEY, Task MEMO, Weight INTEGER, Changed TIMESTAMP);
CREATE TABLE Answers (idTask INTEGER, Solved BOOLEAN, DT TIMESTAMP, Answer MEMO, Changed TIMESTAMP);
CREATE TABLE Scores (DT TIMESTAMP, Daily INTEGER, Earned INTEGER, Spent INTEGER, Changed TIMESTAMP);


//	29.03.2012: Очевидно, придётся делать с внешним dllwrap-ером через user32.dll
//	(new ActiveXObject("WScript.Shell")).AppActivate(IE.LocationName+" - "+IE.Name);	// активирует, но не выносит на пердний план!!!!!!!!!!!!!!!!!!
//	Странно, но user32.dll-SetForegroundWindow делает тоже самое - окно моргает на панели задач, но не активируется и не выносится на передний план!
//	Такой же результат при вызове IE.document.parentWindow.focus();


11.04.2012: Если использовать SQLite, то создать таблицы можно этими командами (но вместо типа MEMO, наверно, лучше использовать TEXT).
Когда в таблицу добавляются записи (INSERT), то для поля id, созданного как INTEGER PRIMARY KEY (даже без AUTOINCREMENT), указав
значение NULL, поле будет автоматически заполняться уникальным ключом (инкреминировать наибольшее значение в колонке).


//	12.04.2012: Все функции (focus, AppActivate, SetForegroundWindow) делают одно и тоже. Выводят IE на передний план, если я больще ничего не делаю
//	(запустил скрипт, создал интерфейс и выдвинул его вперёд). Стоит пользователю активировать вругое окно и после этого каждый вызов любой из этих
//	функций будет заканчиваться лишь морганием интерфейса в панели задач.

// Странно, но если после вызова функции SetForegroundWindow вывести сообщение (WScript.Echo), то окно действительно
// выходит на передний план (а сообщение под ним). Иначе окно на передний план не выводится.
//WScript.Echo("DX.SetForegroundWindow(IE.HWND): " + r);


16.04.2012:
Пробовал использовать sqlite3_exec, но работа этой функции заканчивалась ошибкой
после последнего вызова callback-функции. Не стал особо заморачиваться и перевёл
всё на последовательную обработку (без callback-функции).

17.04.2012:
С кодировкой тут интересно. Текст программы в Win-1251. При работе
скрипта JScript внутри конвертирует и обрабатывает всё в Unicode (UTF-16le),
а SQLite хранит всё-равно в UTF-8. Но главное, что все преобразования прозрачны.


// 25.04.2012: Попробую сначала просто минимизировать все окна. Работает. Можно ещё прикрутить objShellApp.UndoMinimizeAll() [http://www.script-coding.com/WSH/Shell.html]
//	var objShellApp = new ActiveXObject("Shell.Application");
//	objShellApp.MinimizeAll();
//	WScript.Sleep(100);
//	IE.document.parentWindow.focus();
//	(new ActiveXObject("WScript.Shell")).Popup("Window", 5, "Предупреждение");
// С минимизацией окон работает, но не красиво - перепрыгивают все окна.

/*
// Ещё попытка вывести окно вперёд, используя SetWindowPos
	var HWND_TOP = 0;
	var HWND_TOPMOST = -1;
	var HWND_NOTOPMOST = -2;
	var SWP_NOSIZE = 0x01;
	var SWP_NOMOVE = 0x02;
	var SWP_NOACTIVATE = 0x010;
	var SWP_SHOWWINDOW = 0x040;
	DX.Register("user32.dll", "SetWindowPos", "i=hhlllll", "r=l");	// !!! Не восстанавливает окно, если оно свёрнуто !!!
	var r = DX.SetWindowPos(IE.HWND, HWND_TOP, 0, 0, 0, 0, SWP_SHOWWINDOW | SWP_NOMOVE | SWP_NOSIZE);
//WshShell.Popup("DX.SetWindowPos: " + r, 5, "Предупреждение");
*/


10.09.2013:
Была долгая пауза... Особенность в том, что именно эту программу я активно писал перед тяжким событием в жизни.
Прощло больше года, жизнь идёт, потребность в программе актуальна.
Сегодня изменил способ запрета выделения мышкой с древне-нестандартно-IE-шной атрибутом "unselectable" на
стандартную обработку события onselectstart.


13.09.2013:
??? Сделал нормальный вывод вперёд окна. ???
Сделал DynamicWrapperX глобальным объектом - создаётся при начале скрипта и уничтожается при выходе,
а не при каждом вызове процедуры обращения к базе и выводе окна (где она используется).



23.09.2013:
Решил, что нужно сделать не просто выгрузку/загрузку данных, а синхронизацию.
24.09.2013:
Для синхронизации приделал возможность подключения второго файла данных (SQLite позволяет такое - ATTACH/DETACH).
Радикально переделал класс SQLiteDB, изменил структуру базы данных.
На текущий момент каждая таблица имеет поле Changed, в котором хранится временная метка последнего изменения этой записи.
По этой метке (UTC) собираюсь отслеживать изменения для синхронизации.


TODO:
25.04.2012: Надо бы озадачиться типами в базе данных, хоть их всего два (текст и число). Не очень красиво
строку умножать на единицу, чтобы получить числовые значения.



// 13.09.2013: Функция SetForegroundWindow работает, только если вызывающий её процесс является активным. Активный
// процесс тот, чей поток обрабатывает пользовательский ввод (Так и сказано в документации по функции).
// Оказывается, наш процесс может "прикинуться" активным, подключив свой поток к обработке пользовательского ввода.
// Это осуществляется при помощи функции AttachThreadInput. После вызова SetForegroundWindow можно будет отключиться
// от чужого потока, используя эту же функцию. [http://www.rsdn.ru/article/qna/ui/windsetfg.xml]

// 16.09.2013: Сколько было "сломано копий" вокруг SetForegroundWindow, которая работала правильно только первый раз,
// а потом не помагали никакие ухищренья (вывод сообщения, подключения к другому процессу, ...). Сегодня решил попробовать
// функцию SwitchToThisWindow, не для обычного использования и, возможно, в будущем не поддерживаемую. Эта функция
// может переключать в окно и вынасти его вперёд, эмулируя нажатие пользователем Alt/Ctrl+Tab.
// Главное, что она работает, как мне надо!

// 17.09.2013: Что-то "правильность" этой функции тоже пошатнулась... Не всегда переключается в окно. Как уже замучали эти тайные условности!


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
17.12.2013:
На выходных попробовал запустить дома - НЕ РАБОТАЕТ!!!
Раньше всё было нормально. Теперь, толи от того, что IE11 в 64 битной системе, толи что-то ещё покривело...
Скрипт падает в месте, где я подключаю DynamicWrapperX. Причём ругается только на него - другие ActiveXObject-ы
подключает нормально. Можно было подумать на неподписанность dll-ки или несоответствия битности, но, ведь раньше
работало. Подозрение вызывает ещё и невозможность вызвать диалог References в VBA редакторе (Excel). Выскакивает
ошибка вне зависимости от регистрированности в реестре DynamicWrapperX.
Вопрос ограничения времени ещё сильней обострился.
Теперь думаю, что можно сделать.
Буквально недавно думал перенести часть в Интернет, чему способствует бурное развитие его широкополосности.
Смотрю пока в сторону AutoHotKey или другие скриптовые языки, но это значит, что в систему надо ставить
что-то дополнительное.
...
С другой стороны, мне DynamicWrapperX нужен только для SQLite (который я могу заменить на ADODB либо XML) и
для вызова некоторых процедур системных библиотек, что более критично (вывод окна на передний план).
...
Сегодня попробовал PowerShell с динамически созданным диалогом - свойство $objForm.Topmost = $True работает,
хотя это протестировано для немодального окна!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Однако, если окно интерфейса просто минимизировать, а потом передать ему фокус, то оно выходит на передний план!!!!!


18.12.2013:
Смена версии!
Вчера выбирал между технологиями .NET и PowerShell. Почти решил перейти на PowerShell.
Но переход на другие технологии слишком накладен по времени.
Сегодня утром передумал. Поскольку основная насущная проблема - это невозможность использования DynamicWrapperX,
решил просто убрать использование этой библиотеки, и, как следствие, использование SQLite.
С этими технологиями я наэксперементировался. Опыт оставлен в bak-файлах и других скриптах.
Теперь думаю использовать для базы данных XML (доступ к локальным файлам долен быть доступен без проблем даже из IE),
а для переноса окна на передний план - написать и скомпилировать внешнюю программку на AutoHotkey.

Написал маленькую программку на AutoHotkey для вывода нужного окна на передний план - WinActivate.exe.
TODO: Надо устроить проверку наличия WinActivate.exe перед работой.

Теперь надо перевести базу на XML.

19.12.2013:
Я так подумал, что перевод на XML может затянуться, т.к. это отход от SQL запросов. Проще будет пока перейти на ADODB,
в частности, на mdb.

22.12.2013: К сожалению, поле типа TIMESTAMP в формате миллисекунд не импортируется в Дату/Время. Решил, чтобы не терять
миллисекундную точность поменять тип поля Changed на TEXT, поскольку 'unixepoch' в LongInt не укладывается.
23.12.2013: Оказывается, TIMESTAMP ('unixepoch') в SQLite всё-равно имеет точность секунд, последние три нуля
миллисекунд даже не пишутся в поле! Поэтому все поля Changed перевожу на Дату/Время.
Перевёл всё кроме синхронизации на mdb.
В mdb есть встроенный механизм синхронизации - репликация (Microsoft® Jet and Replication objects (JRO)). Пока подумаю,
какой вариант использовать: репликацию (тогда не нужны поля Changed) либо собственный механизм.
26.12.2013: Завершил переход на реплицированные базы mdb. Оказалось очень легко и удобно.

28.12.2013: Даже с mdb оказалось не всё так просто. "Грабли" встретились опять в 64-битности ОС, которая по-умолчанию не имеет
драйверов OLEDB. Офис у меня стоял 32-битный, соответственно и драйвера OLEDB. AccessDatabaseEngine_x64 не устанавливается,
если стоит 32-битный офис. Пришлось поставить новый 64-битный офис и сверху AccessDatabaseEngine_x64. Тогда заработали
стандартный драйвер и провайдер "Microsoft.ACE.OLEDB.12.0". Так и не заработал провайдер "Microsoft.Jet.OLEDB.4.0".
29.12.2013: Офис обновился и перестал работать провайдер "Microsoft.ACE.OLEDB.12.0", ссылаясь на то, что не поддерживаются
реплицированные базы данных.
Пока в 64-битной ОС работает только стандартный драйвер "Driver={Microsoft Access Driver (*.mdb, *.accdb)};", а
в 32-битной ОС работает только "Microsoft.Jet.OLEDB.4.0".
!!! Всё так и идёт к переходу в Интернет, чтобы браузер работал с сайтом, и там же была база данных, а локально крутилась
только программа (например, написанная на AutoHotKey), которая считает время, и, когда надо, запускает браузер.
!!! На текущий момент есть баг - при закрытии программы, например при выходе ползователя, изменения об уже отработанном
времени в базу данных не вносятся.
* Сделал ежеминутную запись в базу данных сведений об отработанном времени (лучше, чем потерять информацию об отработанном
времени при закрытии скрипта.

06.01.2014:
Модернизирую проект TimeControl.
Решил перейти на AutoHotkey. Эксперементируя с его возможностями, меняю концептуальные положения своего проекта:
1) Перенести в Интернет (на хостинг/сервер) базу данных и HTML-ное содержимое. Локально оставить только
программку, которая постоянно висит в трэе, считает время, общается с сервером и, при необходимости, запускает
браузер для решения задач (зарабатывания времени).
2) Пескольку в AutoHotkey есть возможность управлять своей иконкой и меню в трэе, появилась мысль отменить
параметры командной строки, проверку уже работающего приложения, передачу сообщений между экземплярами приложения
и прочую ненужность. Использовать возможности:
- всплывающих подсказок для отображения оставшегося времени;
- меню иконки в трэе для переключения режимов.

11.01.2014:
Очередные "грабли" с доступом к данным в 64-битной системе - объекта JRO нет в принципе!
Поэтому, если в 32-битной системе синхронизация между двумя базами работает, то дома,
в 64-битной системе - нет. Почитал в дорожной карте Microsoft-а про базы данных.
[http://msdn.microsoft.com/en-us/library/ms810810.aspx] Прекращена поддержка объектов
работы с базами данных таких, как Jet, JRO, и т.п. MDAC сменил название на WDAC.
DAO (последняя версия 3.6) считается устаревшим, в 64-битных системах не доступен.
Рекомендовано переходить на MSSQL (compact/express/...).
Отсюда следует необходимость скорейшего перехода на клиент-серверную модель.

13.01.2014:
Можно использовать (проверено) встроенный Gui с ActiveX HTMLFile или MSHTML, но я пока использую отдельный браузер.

16.01.2014:
IE (11 версия) работает очень своеобразно: Пока он не загружен, запуск его порождает процесс, который нормально
отслеживается. Однако, если уже запущен какой-либо его экземпляр, то порождённый процесс удаляется, создаётся
новый процесс со своим окном.
16.01.2014:
Придётся перейти как раз на этот WebBrowser Object [http://msdn.microsoft.com/en-us/library/aa752085], потому что
чехарда получается с HWND при запуске IExplore.exe.

22.01.2014:
Наконец-то хоть какая-то рабочая версия web-части.

23.01.2014:
TODO: В GUI буфер обмена работает только через контекстное меню. Нужно либо отремонтировать буфер обмена,
либо вообще отказаться от редактирования задач в GUI потому, как это теперь удобней делать
через Интернет в браузере, но для этого стоит сделать авторизацию на сервере.
23.01.2014: TODO: Думаю, что каждый раз создавать объект XMLHTTP, чтобы сделать один запрос, а потом этот объект
удалять - не очень разумно. Наверно, стоит создать этот глобально, и пользоваться им можно не только тут, а
ещё, например, для хранения конфигурации не в ini-файле, а в xml (может даже на сервере).

25.01.2014:
Поскольку на сайте, где это всё хостится все данные основного сайта в кодировке win-1251, то
в конфигурации MySQL (файл /ets/my.cnf (/var/db/mysql/my.cnf)) 19.12.2013 я вписал
'character-set-server = utf8' и 'init-connect = "set names cp1251"'. Это для того, чтобы
правильно отображались русские символы. Поэтому надо либо основной сайт перевести на utf8,
либо перед запросом переключить вывод на utf-8. Вечером 24.01.2014 я попробовал перевести
основной сайт на utf-8. Получилось, хотя не без шороховатостей, и, опасаясь возможных проблем,
я отложил это на будущее [http://dev.mysql.com/doc/refman/5.7/en/charset-connection.html].

11.02.2014:
* Изменил обработку закрытия GUI в tc5.ahk. Поскольку Стас его спокойно закрывал из панели задач,
и ежеминутно это делать его не напрягало, я решил-таки запретить закрытие окна, если время уже кончилось.
* Изменил порядок сортировки в режиме редактирования задач (tc.php), чтобы при создании новой задачи не
нужно было мотать весь список вниз (кстати, в Chrome список строится задом наперёд).

12.02.2014:
Стал рассматривать, как проще писать дроби и прочие математические штучки. Оказалось, что средств не мало.
Есть спецификация w3c - MathML [http://www.w3.org/Math/], но её кроме FireFox не поддерживает. Chrome, так
вообще пока отказался от него, хотя MathML является частью спецификации HTML5.
Зато нашёл там таблицу стилей [http://www.w3.org/TR/mathml-for-css/#d2e2482], добавив которую на страницу,
получаем приличную поддержку MathML в IE (и др. браузерах).
Кроме этого есть [http://en.wikipedia.org/wiki/MathML#Web_conversion] несколько JavaScript библиотек, которые
зачастую всё-равно требуют наличие плагина в IE. А вот MathJax [http://www.mathjax.org/], похоже, самодостаточен.
Плюс эти библиотеки поддерживают не только MathML, но и другие (более простые) языки описания математических формул.
Пока начал использовать CSS для MathML.

13.02.2014:
Нашёл замечательный ресурс [http://www.wiris.com/editor/demo/ru/mathml-latex.html] для конвертации
математических форматов в режиме WYSIWYG. На w3c можно много чего найти по теме [http://www.w3.org/Math/Software/].

17.02.2014:
В выходные выяснилась ещё одна особенность. Стас, как он сказал "накапливает" баллы - решает задачку -появляется
возможность закрыть интерфейс, а он просто сдвигает окно ниже, и делать это каждую минуту тоже не очень напрягает.
Поэтому сделал прослушку события перемещения окна и возврат его обратно.

18.02.2014:
Решил отказаться от режима администратора. Этот режим я до сих пор использовал только для выхода из приложения,
а редактировал и добавлял задачи всегда только в браузере. А вот для завершать приложение буду по поролю.

20.02.2014:
Добавил проверку INPUT type="radio". В вопросе для объединения их в группу, нужно группе задать одно имя (атрибут name),
и ТОЛЬКО правильному варианту - вписать атрибут RA с непустым значением.
На текущий момент работает, но записывает ответы некрасиво: отвеченный и правильный варианты или один, если ответ верен.
TODO: Сделать типа макроязык для полей ввода - в вопросе (в базе) писать некими метатэгами, а на странице
распаковывать в соответствущие тэги, например, типа JSON. Тогда типы полей можно свободней определять и использовать
не стандартные тэги, а вариации объектов combobox, checkbox и пр. как в библиотеках, например webix, dhtmlx и др.
А типов полей всего-то надо:
1) ввод текста (с возможной корректировкой, например, запятой); - вариант ответа неизвестен, хорош для задачек
	{"INPUT": {"type": "Text", "RA":10}}
2) выбор - сейчас мне кажется лучшим что-то типа фиксируемых кнопок (таблица, выбранная ячейка подсвечивается)
	одного:
	{"INPUT": {"type": "Select", "Options": {"1":"Вариант 1", "2": "Вариант (текст MathML) 2", "3": "Вариант (текст HTML) 3"}, "RA": 1, "Multi": false}}
	или несколько из вариантов:
	{"INPUT": {"type": "Select", "Options": {"1":"Вариант 1", "2": "Вариант (текст MathML) 2", "3": "Вариант (текст HTML) 3"}, "RA": [1, 2, 3], "Multi": true}}
3) ???

21.02.2014:
Полностью перешёл на MathML (перевёл все старые дроби, введённые в таблицы, на MathML).

26.02.2014:
Сделал в режиме редактирования подсказки правильных вариантов и вывод даты-времени правильного ответа.
Поскольку тэг INPUT не имеет содержимого, то использовать стили для подсказки правильных вариантов нет возможности.
Когда перейду на макроязык, то это можно будет перевести в стили.

28.02.2014:
Вывел в ini-файл параметры MarginHeight и MarginWidth - отсуп от краёв экрана в пикселях по вертикали
и горизонтали соответственно.
Решил проблему с полноэкранным режимом игрушек - обрабатываю событие смены активного окна. Если пытается
активироваться какое-то другое окно, то через 5 секунд обратно активирую окно с задачами.

03.03.2014:
Стас научился снимать приложения в диспетчере задач. Надо что-то предпринять.
Пока самый простой вариант - запретить запуск диспетчера задач политикой:
HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System параметр REG DWORD DisableTaskMgr значение 1.

12.03.2014:
Стас как-то умудряется игнорировать выполнение программы.
Я нашёл такие баги: 
- если сервер недоступен, то появляется сообщение, которое можно отодвинуть и не обращать на него внимание, и
более того - выйти из программы, поскольку стандартное меню ещё не переопределено.
* Начал переход на мультипользовательский вариант (использование идентификатора пользователя).
* Чтобы не плясать с правами на ini-файл и простой доступностью его содержимого, пернёс конфигурацию в реестр.
	При начале эксплуатации надо создать там несколько параметров.
	Обязательно:
		ServerURL (REG_SZ) - адрес php страницы;
		UID (REG_SZ) - идентификатор пользователя (на 12.03.2014 ещё не используется).
	Желательно:
		Secret (REG_SZ) - пароль для выхода из программы

13.03.2014:
Сделал локальное логирование действий

08.05.2014:
Сделал проверку активности окна при ежеминутном опросе оставшегося времени, а то сообщения о переключении
окна, особенно когда есть какое-нибудь полноэкранное окно, не всегда "доходят".

17.09.2014:
Продолжаю перевод на мультипользовательское использование.
TODO: Заменить все alert-ы на какое-нибудь сообщение, которой убирается со временем (есть подозрение,
что во время показа диалога (alert-а) есть возможность переключиться в другое окно).

19.09.2014:
* Заменил все alert-ы на сообщение в блоке на странице, сделал его НЕ модальным.
* Внедрил многопользовательский вариант.
	TODO: Нужно ввести ещё одну таблицу - Users, где хранить настройки пользователя:
		- идентификатор;
		- количество "дормавого" времени в день;
		- уровень сложности (класс) {относительно даты рождения/регистрации};
		- другие параметры, например, пароль для выхода, блокировать ли запуск диспетчера задач, ...

22.09.2014:
Доделал инсталляционный скрипт "tc_setup.vbs"

06.10.2014:
Обнаружилось, что Стас, не имея возможности запустить диспетчер задач, снимает задачу так:
открывает браузер с несколькими вкладками, или ещё что-то "тяжёлое", инициирует выход из системы, и
пока система долго думает, показывая какие задачи осталось закрыть, он отменяет выход. Зачастую моя
задачка закрывается до окончательного выхода.
TODO: Нужно либо убрать скрипт из списка приложений, либо запретить возможность прерывать выход из системы.

05.11.2014:
Перенёс объявление пунктов всплывающего мень после определения оставшегося времени и попытки загрузки
страницы с задачами. Это потому, что при старте компьютера система нагружена, а обращение к серверу за
определением времени, загрузка обекта WebBrowser (IE) и открытие им страницы сервера может занимать
немалое время. За это время, если несколько раз щёлкать пункт меню "Решить...", тем самым требуя
открыться незагруженный объект, система полагала, что программа не отвечает на её запросы и предлагала
пользователю закрыть приложение.

14.11.2014:
Выложил скрипт и предложение о сотрудничестве в "Серый форум"
[http://forum.script-coding.com/viewtopic.php?id=10153].

18.11.2014:
Одно из сообщений в моей ветке Серого форума (там было про "#NoTrayIcon") натолкнуло на мысль убрать
иконку до момента готовности программы к работе, что и осуществил ("Menu, Tray, NoIcon").

07.12.2014:
Появилась мысль как запретить снимать задачу в диспетчере задач: в Windows можно каждому процессу определить
дескриптор безопасности. Для меня достаточно запретить пользователю прерывать (Terminate) процесс, и тогда
можно не запрещать диспетчер задач, а при попытке снять задачу пользователь получит сообщение, что у него
недостаточно прав, хоть процесс запущен от его имени.
Вчера и сегодня писал изменения дома. Поскольку делать управление правами и дескрипторами нет времени,
срочно решил сделать обновление программы с сервера. Сделал примитивно - по дате и времени исполнимого
файла, причём из времени модификации файла не учитываю часы, чтобы не маяться с часовыми поясами.
Для инсталлятора планирую использовать 7-zip и модифицированный sfx-модуль [http://7zsfx.info/ru/].
Можно, как я и хотел, использовать серверный zip-архиватор и тогда подойдёт [https://code.google.com/p/jgef/wiki/zipSfx]

08.12.2014:
Решил сделать нормальный скрипт установки, и, чтобы не запрашивать лишний раз повышение прав для записи
программы при устаноке (обновлении) в системные папки, назначать права в скрипте установки.

17.12.2014:
Сделал назначение дескриптора безопасности процесса. 10 дней упорного исследования. Не всё гладко с
системными вызовами (может быть утечка памяти), но самое главное - работает! Теперь пользователю недостаточно
прав для завершения процесса.

22.12.2014:
Реализовал пожелания от 23.01.2014 - сделал глобальный объект xmlhttp, и встроил туда функции получения
версии и запроса оставшегося времени.

25.12.2014:
Завершил внедрение инсталлятора в саму программу. Теперь программа может обновлять сама себя без
внешних помощников, а для первичной уистановки можно загрузить с сайта исполнимый файл и запустить
его с параметром "-install".

31.12.2014:
Вчера Стас мне показал, как он "валит" мою программу: при загрузке, когда система сильно занята он
руками запускает ещё одну копию программы и, продолжая нагружать систему запуском тяжёлых приложения,
получает сообщение об отсутствии ответа от программы с предложением закрыть программу, чем и пользуется.
Однако, вчера такой способ не сработал, но сработал другой: тоже, когда система сильно нагружена при
загрузке, говорит системе, что пора выйти, и пока она старается закрыть приложения, которые ещё толком
запустить не успела, Стас прерывает выход, нажимая отмену в списке приложений, ожидающих завершения.
Такой способ закрыл мою программу, которая ещё даже не успела прорисовать иконку в трэе.

10.01.2015:
Сделал страничку полной статистики. Теперь можно посмотреть всю статистику по дням.
Пример запроса: http://termopuls.ru/tc/tc.php?uid=001&cmd=getFullStat
Добавил таблицу пользователей (users), но пока не задействовал её.

21.01.2015:
TODO: Для борьбы с "прерванным выходом", да и "отсутствием ответа", можно попробовать всё-таки
разделить программу: Часть будет работать службой, и, пока контролируемый пользователь залогинен,
будет всё контролировать (время, иконку и пр.) или просто проверять, что программа запущена.

Сделал удаление альтернативного потока "Zone.Identifier" при установке. Браузер (а при первичной
устаноке предполагается скачивание файла именно им) записывает в этот поток сведения о происхождении
файла и поток этот копируется вместе с файлом при простом копировании файла. Если файл из интернета,
то система будет каждый раз запрашивать разрешение на запуск файла. Чтобы избавиться от такого запроса,
я удаляю этот поток.

22.01.2015:
При запуске из произвольной директории (не оттуда, где должна находиться программ), независимо от наличия
параметров, считается, что производится первичная установка. Соответственно, установка может быть интерактивной
(запрос класса (уровень сложности заданий), имя и идентификатора пользователя). При соответствии директории
программы установочной и наличии параметра "-update" происходит обновление программы до новой версии
без вывода запросов и сообщений пользователю.

11.03.2015:
Изменил способ перезапуска приложения через временный bat-файл и поставил "#SingleInstance ignore", чтобы
исключить возможность запуска множественных копий программы (кажется именно при большой очереди процессов
в ожидании самозамены экземпляра в памяти и позволяет системе решить, что программа не отвечает и позволяет
закрыть её).

